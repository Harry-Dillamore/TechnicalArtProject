# Auto Landscape Materials - Harry Dillamore

## Height Based

| **Requirement** | **Description / Implementation** | **Evidence** |
| --- | --- | --- |
| **Landscape Material Setup** | I use material functions to set up each part of the material then use the `Landscape Layer Blend` node to combine these textures. This means that the material contains all of the materials and the user is able to paint the landscape once the material is applied. The heightmap input also allows the blending to use the heightmap of each texture in order to make a more convincing transition between materials. | ![alt text](image-23.png) |
| **Landscape Blending Based on Height** | The material system chooses the appropriate texture by using the `Absolute World Position` Z-axis. The aim is then to create a 0 - 1 value which is used as the alpha input for a `BlendMaterialAttributes` node which `LERPs` between two materials. To create this 0 - 1 value, I use configurable parameters to adjust: the `falloffHeight` which is subtracted from the Z-axis to set the level at which the material is applied, and the `falloffRange` which changes the size of the transition, with a larger number meaning that it blends more gradually over a larger distance in height. An example of how this system works would be if grass is applied with: `falloffHeight` = 25000, `falloffRange` = 2000. Then at a height of 26000 the calculation would be $ {26000-25000 \over 2000} = 0.5 $, meaning that the grass texture would be applied at half strength. To avoid values beyond 0 and 1, a `saturate` node is used to clamp anything outside of this range to either 0 or 1. I created different zones by adjusting the falloff height of the different materials in my landscape material instance. The values I found worked were as seen in the screenshot of my material parameters. I think these values were effective because they used large values for the falloff ranges, meaning that the blending was smooth. I think the look of this could be improved if some noise was introduced into the height blend as it would break up the bands of materials that can be seen when looking at the landscape. | ![alt text](image-22.png) ![alt text](image-20.png) <br> ![alt text](image-21.png) <br> ![alt text](image-24.png) |

## Slope Based

| **Requirement** | **Description / Implementation** | **Evidence** |
| --- | --- | --- |
| **Slope Calculation** | The landscape material blends textures using the world space slope of the landscape. This is done by taking the `VertexNormal` - which is a normalised Vector3 representing the direction that the vertex is facing in the world - and comparing it with an upwards vector (0, 0, 1) using a `dot Product`. The dot product node returns a value between 1 (if the vectors are the same) and -1 (if the vectors are pointing in opposite directions). This range is then remapped to set the parameter `FalloffPN` as the 0 end of the range, with a flat surface as 1. Meaning that the material will blend from fully visible on a flat surface, to gone at whichever value the user inputs with a smooth transition in between. | ![alt text](image-25.png) |
| **Layer Blending** | I tried for a long time to get layer blending to work properly rather than using a sequence of `BlendMaterialAttributes` nodes as I have done in my current solution. However, I was finding that I could not get the materials layers to apply based on the procedural rules I had written. It should function by having each material filling the landscape, so that which material appears visually is decided by the height values of the layers (the material with the biggest height value would be most visible), which would be generated using the procedural rules. However, I could only get one material to fully cover the landscape at a time, meaning that the height blend was essentially never used because there were no overlapping materials. |  |
| **Guiding Questions** | Using slope based blending simulates real life landscapes and geology because, for example, you would not see grass growing or snow settling on steep cliff in real life. The `PNFalloff` and `PNContrast` parameters allow the user to adjust the steepness and blending area of the differant materials, meaning that they can observe real life examples of the things similar to the material in use, and aim to match any patterns they see. Complex geometry and overhangs can be handled largly by the procedural system. This is because I have set the rock texture as the base texture, and draw everything else on top of it, for example, grass on flat surfaces below their falloff limit. This means that even if the geometry is overhanging or complex, if it does not meet the requirements for any other material to be painted, it would default to the rock texture. |  |